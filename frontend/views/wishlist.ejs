<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wishlist & Product Comparison</title>
    <link rel="stylesheet" href="/wishlist.css">
</head>
<body>
    <div class="Window">
    <%- include("HomeHeader.ejs") %>
    <div class="container">
        <div class="sidebar">
            <h2>Wishlist</h2>
            <div id="product-list"></div>
        </div>

        <div class="main">
            <h2>Compare Products</h2>
            <div id="comparison-container"></div>
        </div>
    </div>
</div>
    <script>
            // <% console.log("fedlfn") %>
            const products = <%- JSON.stringify(products) %>;
            // console.log(products); // apotential issue password is visible need to solve
            for(let product of products){
                product[`Images`]=new Array();
                for(let i=0;i<product.images.length;i++){
                    product[`Images`].push(product.images[i]);
                }
                // console.log(product[`Images`].length);
            }
            // console.log(products.Images);
            /*
            [
    {
        Name: "Men's Cotton T-Shirt",
        Price: "₹909",
        ID: "001", 
        Serialno: "SN-0001",
        Address: "123 Fashion Street, Mumbai, India",
        Description: "Cotton, Color: Pomegranate, Size: M, L, XL",
        PostingDate: "11 Sep 2023",
        CountryCode: "IN",
        ZipCode: "400059",
        Seller: "Best United India Comforts Pvt. Ltd.",
        Images: ["./imagesphotos/chair1.jpg"],
    },
    {
        Name: "Women's Maxi Dress",
        Price: "₹849",
        ID: "002", 
        Serialno: "SN-0002",
        Address: "456 Lifestyle Avenue, New Delhi, India",
        Description: "Maxi Dress, Women, Color: Black",
        PostingDate: "3 Aug 2024",
        CountryCode: "IN",
        ZipCode: "110001",
        Seller: "Pinkberry Delhi",
        Images: ["./maxidress1.jpg", "./maxidress2.jpg", "./maxidress3.jpg"]
    },
    {
        Name: "Redmi Note 12 Pro+ 5G",
        Price: "₹29,999",
        ID: "003", 
        Serialno: "SN-0003",
        Address: "Mi Store, 123 Tech Street, Bangalore 560001, India",
        Description: "Display: 6.67-inch Pro-AMOLED 120Hz, Processor: MediaTek Dimensity 1080 5G, RAM: 8GB/12GB, Storage: 256GB, Rear Camera: 200MP+8MP+2MP, Front Camera: 16MP, Battery: 4980mAh with 120W fast charging, OS: MIUI 13 (Android 12)",
        PostingDate: "14 March 2025",
        CountryCode: "IN",
        ZipCode: "560001",
        Seller: "Xiaomi India",
        Images: ["./redmi12pro1.jpg", "./redmi12pro2.jpg", "./redmi12pro3.jpg"]
    },
    {
        Name: "OnePlus 11 5G",
        Price: "₹56,999",
        ID: "004", 
        Serialno: "SN-0004",
        Address: "OnePlus Experience Store, 789 Infinity Mall, Mumbai 400001, India",
        Description: "Display: 6.7-inch 120Hz LTPO3 AMOLED, Processor: Snapdragon 8 Gen 2, RAM: 8GB/16GB, Storage: 128GB/256GB, Rear Camera: 50MP+48MP+32MP, Front Camera: 16MP, Battery: 5000mAh with 100W SuperVOOC charging, OS: OxygenOS 13 (Android 13)",
        PostingDate: "14 March 2025",
        ZipCode: "400001",
        CountryCode: "IN",
        Seller: "OnePlus India",
        Images: ["./oneplus11_1.jpg", "./oneplus11_2.jpg", "./oneplus11_3.jpg"]
    },
    {
        Name: "Dell XPS 15 Touchscreen Laptop",
        Price: "₹1,89,999",
        ID: "005", 
        Serialno: "SN-0005",
        Address: "555 Silicon Valley, Hitech City, Hyderabad, Telangana 500081, India",
        Description: "Processor: Intel Core i7-13700H / i9-13900H, Display: 15.6-inch OLED 3.5K Touch, 3456 x 2160, RAM: 16GB / 32GB / 64GB, Storage: 512GB / 1TB / 2TB SSD, Battery Life: Up to 13 hours, Weight: 1.9 kg, Connectivity: Wi-Fi 6E, Bluetooth 5.3, Thunderbolt 4, HDMI, Color: Platinum Silver",
        PostingDate: "March 2023",
        ZipCode: "110006",
        CountryCode: "USA",
        Seller: "Dell India Pvt Ltd",
        Images: ["./dellxps1.jpg", "./dellxps2.jpg", "./dellxps3.jpg"]
    },
    {
        Name: "HP Spectre x360 2-in-1 Laptop",
        Price: "₹1,74,999",
        ID: "006", 
        Serialno: "SN-0006",
        Address: "888 Gadget Lane, Whitefield, Bengaluru, Karnataka 560066, India",
        Description: "Processor: Intel Core i7-1360P, Display: 13.5-inch WUXGA Touchscreen (1920 x 1280), RAM: 16GB LPDDR4x, Storage: 1TB SSD, Battery Life: Up to 17 hours, Weight: 1.36 kg, Connectivity: Wi-Fi 6E, Bluetooth 5.3, USB-C, HDMI, Color: Nightfall Black",
        PostingDate: "February 2023",
        ZipCode: "110007",
        CountryCode: "IN",
        Seller: "HP India Pvt Ltd",
        Images: ["./hpspectre1.jpg", "./hpspectre2.jpg", "./hpspectre3.jpg"]
    },
    {
        Name: "Sony WH-1000XM5 Noise-Cancelling Headphones",
        Price: "₹29,999",
        ID: "007", 
        Serialno: "SN-0007",
        Address: "234 Audio Plaza, Powai, Mumbai, Maharashtra 400076, India",
        Description: "Noise Cancellation: Industry-leading Active Noise Cancellation, Battery Life: Up to 30 hours, Connectivity: Bluetooth 5.2, USB-C, Weight: 250g, Color: Black / Silver",
        PostingDate: "May 2022",
        ZipCode: "110001",
        CountryCode: "IN",
        Seller: "Sony India Pvt Ltd",
        Images: ["./sonywh1.jpg", "./sonywh2.jpg", "./sonywh3.jpg"]
    },
    {
        Name: "Apple Watch Series 9 (GPS + Cellular)",
        Price: "₹45,900",
        ID: "008", 
        Serialno: "SN-0008",
        Address: "101 Apple Store, Phoenix Marketcity, Kurla, Mumbai, Maharashtra 400070, India",
        Description: "Display: Always-On Retina Display, Processor: S9 SiP, Battery Life: Up to 18 hours, Connectivity: Wi-Fi, Bluetooth 5.3, GPS, Cellular, Water Resistance: WR50 (Swim-proof), Color: Midnight / Starlight / Product Red / Silver / Pink",
        PostingDate: "September 2023",
        ZipCode: "110004",
        CountryCode: "IN",
        Seller: "Apple India Pvt Ltd",
        Images: ["./applewatch1.jpg", "./applewatch2.jpg", "./applewatch3.jpg"]
    },
    {
        Name: "Ergonomic Office Chair with Lumbar Support",
        Price: "₹8,999",
        ID: "009", 
        Serialno: "SN-0009",
        Address: "777 Furniture Hub, MG Road, Gurgaon, Haryana 122002, India",
        Description: "Material: Mesh & Metal, Features: Adjustable Height, Reclining, 360-degree Swivel, Color: Black, Weight: 15 kg, Dimensions: 65 x 65 x 120 cm",
        PostingDate: "March 2023",
        ZipCode: "110009",
        CountryCode: "IN",
        Seller: "Furniture World Pvt Ltd",
        Images: ["./bookshelf1.jpg", "./bookshelf2.jpg", "./bookshelf3.jpg"]
    },
    {
        Name: "Modern Bookshelf with 5 Shelves",
        Price: "₹7,999",
        ID: "010", 
        Serialno: "SN-0010",
        Address: "222 Home Decor Street, Koramangala, Bengaluru, Karnataka 560034, India",
        Description: "Product Dimensions: 80 x 30 x 180 cm, Weight: 25 kg, Material: Engineered Wood, Color: White & Oak",
        PostingDate: "20 January 2024",
        ZipCode: "110012",
        CountryCode: "IN",
        Seller: "UrbanSpace Pvt Ltd",
        Images: ["./bookshelf1.jpg", "./bookshelf2.jpg", "./bookshelf3.jpg"]
    },
    {
        Name: "The Alchemist by Paulo Coelho",
        Price: "₹399",
        ID: "011", 
        Serialno: "SN-0011",
        Address: "333 Book Lane, Churchgate, Mumbai, Maharashtra 400020, India",
        Description: "Pages: 208, Language: English, Genre: Fiction, Publisher: HarperCollins",
        PostingDate: "8 February 2024",
        ZipCode: "110013",
        CountryCode: "IN",
        Seller: "BookWorld Pvt Ltd",
        Images: ["./alchemist1.jpg", "./alchemist2.jpg", "./alchemist3.jpg"]
    },
    {
        Name: "The Psychology of Money",
        Price: "₹499",
        ID: "012", 
        Serialno: "SN-0012",
        Address: "101 Knowledge Avenue, Connaught Place, New Delhi 110001, India",
        Description: "Author: Morgan Housel, Genre: Personal Finance, Pages: 252, Language: English, Publisher: Harriman House",
        PostingDate: "14 February 2024",
        ZipCode: "110001",
        CountryCode: "IN",
        Seller: "Harriman House Publishers",
        Images: ["./psychology_money1.jpg", "./psychology_money2.jpg", "./psychology_money3.jpg"]
    },
    {
        Name: "Hero Sprint Next 26T Mountain Bike",
        Price: "₹12,999",
        ID: "013", 
        Serialno:"SN-0013",
        Address: "666 Cycle Street, Ludhiana, Punjab 141001, India",
        Description: "Gear: Single-Speed, Frame: Steel, Wheel Size: 26 inches, Color: Red & Black",
        PostingDate: "05 March 2024",
        ZipCode: "110015",
        CountryCode: "IN",
        Seller: "Hero Cycles Ltd",
        Images: ["./hero1.jpg", "./hero2.jpg", "./hero3.jpg"]
    },
    {
        Name: "Firefox Bad Attitude 10 27.5T Mountain Bike",
        Price: "₹15,999",
        ID: "014", 
        Serialno: "SN-0014",
        Address: "999 Adventure Road, Manesar, Gurgaon, Haryana 122050, India",
        Description: "Gear: 21-Speed, Frame: Aluminum, Wheel Size: 27.5 inches, Color: Black & Yellow",
        PostingDate: "18 February 2024",
        ZipCode: "110019",
        CountryCode: "IN",
        Seller: "Firefox Bikes Pvt Ltd",
        Images: ["./firefox1.jpg", "./firefox2.jpg", "./firefox3.jpg"],
        count:0,
        distance:0
    },
    {
        Name: "Nike Premier League Football (Size 5)",
        Price: "₹1999",
        ID: "015", 
        serialno: "SN-0015",
        Address: "777 Sports Arena, Salt Lake City, Kolkata, West Bengal 700091, India",
        Description: "Material: PU Leather, Weight: 450g",
        PostingDate: "22 January 2024",
        zipCode: "110016",
        CountryCode: "IN",
        Seller: "Nike India Pvt Ltd",
        Images: ["./football1.jpg", "./football2.jpg", "./football3.jpg"],
        count: 0,
        distance: 0
    },
    {
        Name: "Adidas Predator Edge Football Shoes",
        Price: "₹5999",
        ID: "016", 
        serialno: "SN-0016",
        Address: "888 Athletic Street, Banjara Hills, Hyderabad, Telangana 500034, India",
        Description: "Material: Synthetic, Weight: 350g",
        PostingDate: "10 March 2024",
        zipCode: "110020",
        CountryCode: "IN",
        Seller: "Adidas India Pvt Ltd",
        Images: ["./shoes1.jpg", "./shoes2.jpg", "./shoes3.jpg"],
        count: 0,
        distance: 0
    },
    {
        Name: "Yamaha F280 Acoustic Guitar",
        Price: "₹8499",
        ID: "017", 
        serialno: "SN-0017",
        Address: "555 Music Lane, T Nagar, Chennai, Tamil Nadu 600017, India",
        Description: "Material: Spruce & Mahogany, Color: Natural",
        PostingDate: "15 February 2024",
        zipCode: "110017",
        CountryCode: "IN",
        Seller: "Yamaha Music India",
        Images: ["./guitar1.jpg", "./guitar2.jpg", "./guitar3.jpg"],
        count: 0,
        distance: 0
    },
    {
        Name: "Casio CT-X700 Keyboard",
        Price: "₹11499",
        ID: "018", 
        serialno: "SN-0018",
        Address: "444 Melody Road, Jubilee Hills, Hyderabad, Telangana 500033, India",
        Description: "Material: Plastic, Color: Black",
        PostingDate: "28 February 2024",
        zipCode: "110021",
        CountryCode: "IN",
        Seller: "Casio India Co. Ltd",
        Images: ["./keyboard1.jpg", "./keyboard2.jpg", "./keyboard3.jpg"],
        count: 0,
        distance: 0
    },
    {
        Name: "Ray-Ban Aviator Sunglasses",
        Price: "₹12999",
        ID: "019", 
        serialno: "SN-0019",
        Address: "333 Fashion Square, Linking Road, Bandra, Mumbai, Maharashtra 400050, India",
        Description: "Frame Material: Metal, Lens Material: Glass, Color: Gold & Green",
        PostingDate: "07 January 2024",
        zipCode: "110018",
        CountryCode: "IN",
        Seller: "Ray-Ban India",
        imageUrls:{
            mainUrl:"https://m.media-amazon.com/images/I/61fqF837sYL.SY675.jpg",
            url2:"https://m.media-amazon.com/images/I/71h8QFuWIyL.SY675.jpg",
            url3:"https://m.media-amazon.com/images/I/71zVlyIPfGL.SY675.jpg",
            url4:"https://m.media-amazon.com/images/I/61cFllVpdXL.SY675.jpg"
        },
        distance: 0
    },
    {
        Name: "Fossil Grant Chronograph Watch",
        Price: "₹9999",
        ID: "020", 
        serialno: "SN-0020",
        Address: "222 Time Plaza, Connaught Place, New Delhi 110001, India",
        Description: "Frame Material: Stainless Steel, Strap Material: Leather, Color: Brown & Silver",
        PostingDate: "02 March 2024",
        zipCode: "110022",
        CountryCode: "IN",
        Seller: "Fossil India Pvt Ltd",
        Images: ["./watch1.jpg", "./watch2.jpg", "./watch3.jpg"],
        count: 0,
        distance: 0
    }
];
            */
        const selectedProducts = [];
        const productList = document.getElementById("product-list");
        const comparisonContainer = document.getElementById("comparison-container");
        function loadProducts() {
        products.forEach((product, index) => {
            const productDiv = document.createElement("div");
            productDiv.classList.add("product-item");

            productDiv.innerHTML = `
             <div style="position: relative; text-align: center;">
                    <span style="font-size: 18px; position: absolute; top: 5px; right: 5px; cursor: pointer;">❤️</span>
                <div style="text-align: center;">
                    <img src="<%= backendURL %>${product.Images[0]}" alt="${product.name}" style="width: 100px; height: 100px; margin-bottom: 10px;">
                    <p><strong>${product.name}</strong></p>
                    <p>${product.price}</p>
                </div>
            `;

            productDiv.onclick = () => addToCompare(index);

            productList.appendChild(productDiv);
        });
    }
        
        function addToCompare(index) {
            if (selectedProducts.length >= 3) {
                alert("You can only compare up to 3 products.");
                return;
            }
            if (!selectedProducts.includes(index)) {
                selectedProducts.push(index);
                updateComparison();
            }
        }

        function removeFromCompare(index) {
            selectedProducts.splice(selectedProducts.indexOf(index), 1);
            updateComparison();
        }

        function updateComparison() {
            comparisonContainer.innerHTML = "";
            selectedProducts.forEach(index => {
                const product = products[index];

                const comparisonDiv = document.createElement("div");
                comparisonDiv.classList.add("comparison-card");

                comparisonDiv.innerHTML = `
                    <div class="carousel">
                        <button class="prev" onclick="changeImage(${index}, -1)">❮</button>
                        <img id="img-${index}" src="<%= backendURL %>${product.Images[0]}" alt="${product.name}">
                        <button class="next" onclick="changeImage(${index}, 1)">❯</button>
                    </div>
                    <h3>${product.name}</h3>
                    <p><b>Price :</b>${product.price} Rs</p>
                    <p style="word-break: break-word;"><strong>Description:</strong>${product.description}</p>
                    <p><strong>Seller:</strong> ${product.seller.email}</p>
                    <h3><strong>State :</strong> ${product.state}</h3>
                    <h4><strong>District :</strong> ${product.district}</h4>
                    <h5><strong>City :</strong> ${product.city}</h5>
                    <p><strong>Posting Date:</strong> ${product.postingDate}</p>
                    <p><strong>Zip Code:</strong> ${product.zipCode}</p>
                    <button class="remove-btn" onclick="removeFromCompare(${index})">X</button>
                    <br><br>
                    <a href=/buyer/wishlist/remove/${product._id} id = "DeletefromWishlist">Delete from WishList</a>
                `;

                comparisonContainer.appendChild(comparisonDiv);
            });
        }
        function addToCompare(index) {
    if (selectedProducts.length >= 3) {
        alert("You can only compare up to 3 products.");
        return;
    }
    if (!selectedProducts.includes(index)) {
        selectedProducts.push(index);
        updateComparison();
    }
}
        function changeImage(index, direction) {
            let imgElement = document.getElementById(`img-${index}`);
            let images = products[index].Images;
            let currentSrc = imgElement.src.split("/").pop();
            let currentIndex = images.findIndex(img => img.includes(currentSrc));
            let newIndex = (currentIndex + direction + images.length) % images.length;
            imgElement.src = `<%= backendURL %>${images[newIndex]}`;
        }

        loadProducts();

    const product = document.getElementById("product-list");

    // function displayWishlist() {
    //     products.forEach(product => {
    //         let productDiv = document.createElement("div");
    //         productDiv.classList.add("wishlist-item");

    //         let productImg = document.createElement("img");
    //         productImg.src = product.Images[0]; // Use the first image
    //         productImg.alt = product.Name;
    //         productImg.style.width = "100px"; // Adjust as needed

    //         let productName = document.createElement("p");
    //         productName.textContent = product.Name;

    //         productDiv.appendChild(productImg);
    //         productDiv.appendChild(productName);
    //         productList.appendChild(productDiv);
    //     });
    // }

    // displayWishlist();


    </script>

</body>
</html>
